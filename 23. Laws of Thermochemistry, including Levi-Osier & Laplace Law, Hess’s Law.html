<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  
  
  <title> Quiz ‚Äì 23. Laws of Thermochemistry, including Levi-Osier & Laplace Law, Hess‚Äôs Law</title>
  
  
  <style>
    body{font-family:Arial, sans-serif;padding:20px;background:#121212;color:#f0f0f0;}
    #logo{display:block;margin:0 auto 25px;max-width:180px;}
    #name-container{background:#1e1e1e;padding:30px;border-radius:6px;max-width:420px;margin:0 auto;}
    #name-container input{width:100%;padding:10px;margin:10px 0 15px;border:none;border-radius:4px;font-size:16px;}
    #quiz-container{display:none;}
    .question{border:1px solid #333;padding:15px;margin-bottom:20px;border-radius:5px;background:#1e1e1e;}
    .question h3{margin:0 0 10px;}
    .option-item { display: flex; align-items: center; gap: 8px; margin: 6px 0; padding: 6px 8px; border-radius: 4px; background: #2a2a2a; color: #ccc; cursor: pointer; }
    .option-item input[type="radio"] { margin: 0; }
    .submit-button,.toggle-button,.dontknow-button{margin-top:10px;padding:6px 12px;background:#007BFF;color:#fff;border:none;border-radius:4px;cursor:pointer;margin-right:5px;}
    .solution{display:none;margin-top:10px;background:#2d2d2d;padding:10px;border-left:4px solid #28a745;}
    #scorecard{background:#2d2d2d;padding:15px;border-radius:6px;margin-top:30px;display:none;}
    #timer{font-weight:bold;color:#00ffcc;}
    #studentPrintName{text-align:center;font-size:18px;font-weight:bold;margin-top:-15px;margin-bottom:5px;display:none;}
    #examDateTime{text-align:center;font-size:14px;margin-bottom:20px;display:none;}
    @media print {
      body { background: #fff; color:#000; }
      .submit-button, .dontknow-button, .toggle-button, #reportBtn, #reportModal { display:none !important; }
      #name-container { display:none !important; }
    }
    #reportBtn { position: fixed; bottom: 20px; right: 20px; background: #ff4757; color: white; border: none; padding: 12px 18px; border-radius: 50px; cursor: pointer; font-weight: bold; box-shadow: 0px 4px 10px rgba(0,0,0,0.3); z-index: 1000; }
    #reportModal { display: none; position: fixed; bottom: 80px; right: 20px; background: #1e1e1e; border: 1px solid #444; padding: 15px; border-radius: 8px; width: 260px; z-index: 1001; }
    #reportModal textarea { width: 100%; height: 80px; padding: 8px; border: none; border-radius: 4px; resize: none; font-size: 14px; }
    #reportModal button { margin-top: 10px; padding: 8px 12px; border: none; border-radius: 4px; cursor: pointer; font-weight: bold; }
    #sendReport { background: #28a745; color: white; }
    #closeReport { background: #dc3545; color: white; margin-left: 5px; }
  </style>

  <!-- MathJax Configuration -->
  <script>
    window.MathJax = {
      tex: {
        inlineMath: [['\\(','\\)'], ['$', '$']], 
        displayMath: [['$$','$$'], ['\\[','\\]']],
        processEscapes: true
      },
      options: { skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre'] }
    };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>
<body>

<img id="logo" src="https://i.ibb.co/WNZTWPwv/LOGO-PNG-2025-fab.png" alt="Logo" />

<div id="studentPrintName"></div>
<div id="examDateTime"></div>

<div id="name-container">
  <h2>Enter your name to begin</h2>
  <input type="text" id="studentNameInput" placeholder="Your Name" />
  <button class="submit-button" onclick="startQuiz()">Start Quiz</button>
</div>

<div id="quiz-container">


  <h2> Quiz ‚Äì 23. Laws of Thermochemistry, including Levi-Osier & Laplace Law, Hess‚Äôs Law</h2>
  
  
  <p><strong>Time Elapsed:</strong> <span id="timer">00:00</span></p>
  <div id="questions-container"></div>

  <div style="margin-top:30px;">
    <button class="submit-button" onclick="finalSubmit()">Final Submit</button>
    <button class="submit-button" onclick="printQuestions()">Print Questions</button>
    <button class="submit-button" id="printScoreBtn" onclick="printScorecard()" style="display:none;">Save or Print Scorecard</button>
    <button class="submit-button" id="shareWhatsappBtn" style="display:none;">SHARE on WhatsApp</button>
  </div>

 <div id="scorecard">
  <h3>Your Scorecard</h3>
  <p id="scoreText"></p>
  <table id="scoreTable" border="1" cellspacing="0" cellpadding="6" style="width:100%;border-collapse:collapse;margin-top:15px;">
    <thead style="background:#333;color:#fff;">
      <tr>
        <th>Q.No</th>
        <th>Question</th>
        <th>Your Answer</th>
        <th>Correct Answer</th>
        <th>Result</th>
        <th>Solution</th>
      </tr>
    </thead>
    <tbody id="scoreDetails"></tbody>
  </table>
</div>

<button id="reportBtn">Report Mistake</button>

<div id="reportModal">
  <textarea id="reportMsg" placeholder="Describe the mistake..."></textarea>
  <div style="text-align:right;">
    <button id="sendReport">Send</button>
    <button id="closeReport">Close</button>
  </div>
</div>

<script>


const Q = [
  {
    "id": "q1_thermochemistry",
    "text": "Levi-Osier and Laplace law states that the heat evolved in the formation of a compound is equal in magnitude and opposite in sign to the heat of its decomposition. Which of the following represents this correctly?",
    "options": [
      "A) $q_{formation} = - q_{decomposition}$",
      "B) $q_{formation} = q_{decomposition}$",
      "C) $q_{formation} > q_{decomposition}$",
      "D) $q_{formation} < q_{decomposition}$"
    ],
    "correct": "A",
    "solution": "According to the law, heat released in formation of a compound = heat absorbed in breaking it into elements, but opposite in sign.",
    "solution_steps": [
      "Step 1: Formation reaction: $A + B \\rightarrow AB$ releases heat $q_{formation}$",
      "Step 2: Decomposition reaction: $AB \\rightarrow A + B$ absorbs heat $q_{decomposition}$",
      "Step 3: Therefore, $q_{formation} = - q_{decomposition}$",
      "Step 4: Option A correct"
    ]
  },
  {
    "id": "q2_thermochemistry",
    "text": "Which of the following is a direct consequence of Levi-Osier and Laplace law?",
    "options": [
      "A) Heat of formation of water and heat of decomposition of water are equal in magnitude but opposite in sign",
      "B) Heat of combustion of glucose equals heat of formation of CO2 and H2O",
      "C) Heat of reaction depends on path",
      "D) Heat of neutralization depends on concentration"
    ],
    "correct": "A",
    "solution": "The law directly applies to formation and decomposition reactions, e.g., $H_2 + 1/2 O_2 \\rightarrow H_2O$",
    "solution_steps": [
      "Step 1: Formation of water releases 285.8 kJ/mol",
      "Step 2: Decomposition of water absorbs 285.8 kJ/mol",
      "Step 3: Option A correct"
    ]
  },
  {
    "id": "q3_thermochemistry",
    "text": "Hess‚Äôs Law states that the enthalpy change of a reaction depends only on the initial and final states. Which of the following illustrates Hess‚Äôs Law?",
    "options": [
      "A) $\\Delta H_1 + \\Delta H_2 = \\Delta H_3$",
      "B) $\\Delta H_1 - \\Delta H_2 = \\Delta H_3$",
      "C) $\\Delta H = q \\cdot W$",
      "D) $\\Delta H = \\Delta U + P\\Delta V$"
    ],
    "correct": "A",
    "solution": "Hess‚Äôs Law allows enthalpy of overall reaction to be sum of enthalpies of individual steps.",
    "solution_steps": [
      "Step 1: Consider reactions: A ‚Üí B, B ‚Üí C",
      "Step 2: Enthalpy changes: $\\Delta H_1$ and $\\Delta H_2$",
      "Step 3: Overall reaction: A ‚Üí C, enthalpy $\\Delta H_3 = \\Delta H_1 + \\Delta H_2$",
      "Step 4: Option A correct"
    ]
  },
  {
    "id": "q4_thermochemistry",
    "text": "If $C + O_2 \\rightarrow CO_2$ has $\\Delta H = -393.5$ kJ/mol and $2 CO + O_2 \\rightarrow 2 CO_2$ has $\\Delta H = -566$ kJ, then $2 C + O_2 \\rightarrow 2 CO$ is:",
    "options": [
      "A) $\\Delta H = +221$ kJ",
      "B) $\\Delta H = -221$ kJ",
      "C) $\\Delta H = -959.5$ kJ",
      "D) $\\Delta H = +959.5$ kJ"
    ],
    "correct": "A",
    "solution": "Use Hess's law: $\\Delta H_{C \\rightarrow CO} = \\Delta H_{C \\rightarrow CO_2} - \\Delta H_{CO \\rightarrow CO_2}$",
    "solution_steps": [
      "Step 1: $2C + 2O_2 \\rightarrow 2 CO_2$: $2 \\times (-393.5) = -787$ kJ",
      "Step 2: $2 CO + O_2 \\rightarrow 2 CO_2 = -566$ kJ",
      "Step 3: Subtract: $-787 - (-566) = -787 + 566 = -221$ kJ",
      "Step 4: Since reaction forms CO, enthalpy is +221 kJ",
      "Step 5: Option A correct"
    ]
  },
  {
    "id": "q5_thermochemistry",
    "text": "Experimental verification of Hess‚Äôs law is usually done by:",
    "options": [
      "A) Measuring heat of formation via different reaction paths",
      "B) Measuring pressure changes",
      "C) Using a calorimeter to measure work done",
      "D) Measuring Gibbs free energy"
    ],
    "correct": "A",
    "solution": "By taking multiple paths to convert reactants to products and verifying the total heat change is same, Hess‚Äôs law is experimentally confirmed.",
    "solution_steps": [
      "Step 1: Choose two or more reaction pathways",
      "Step 2: Measure enthalpy changes using calorimeter",
      "Step 3: Verify sum of intermediate reactions equals direct reaction",
      "Step 4: Option A correct"
    ]
  },
  {
    "id": "q6_thermochemistry",
    "text": "If $CaCO_3 \\rightarrow CaO + CO_2$ has $\\Delta H = 178$ kJ/mol, and $CaO + CO_2 \\rightarrow CaCO_3$ has $\\Delta H$ = ?",
    "options": [
      "A) -178 kJ/mol",
      "B) +178 kJ/mol",
      "C) 0 kJ/mol",
      "D) Cannot determine"
    ],
    "correct": "A",
    "solution": "According to Levi-Osier and Laplace law, heat of reverse reaction = - heat of forward reaction.",
    "solution_steps": [
      "Step 1: Forward reaction: $CaCO_3 \\rightarrow CaO + CO_2$, $\\Delta H = 178$ kJ/mol",
      "Step 2: Reverse reaction: $CaO + CO_2 \\rightarrow CaCO_3$, $\\Delta H = -178$ kJ/mol",
      "Step 3: Option A correct"
    ]
  },
  {
    "id": "q7_thermochemistry",
    "text": "Heat of reaction is path independent. Which law justifies this?",
    "options": [
      "A) Hess's Law",
      "B) Le Chatelier's Principle",
      "C) Clausius-Clapeyron Equation",
      "D) Avogadro's Law"
    ],
    "correct": "A",
    "solution": "Hess‚Äôs law states that total enthalpy change depends only on initial and final states, independent of reaction path.",
    "solution_steps": [
      "Step 1: Consider multiple pathways to form a compound",
      "Step 2: Sum of enthalpies of individual steps = enthalpy of direct reaction",
      "Step 3: Option A correct"
    ]
  },
  {
    "id": "q8_thermochemistry",
    "text": "Application of Hess‚Äôs law: Calculation of enthalpy of formation of $CH_4$ from $C$ and $H_2$ using known enthalpies of combustion.",
    "options": [
      "A) $\\Delta H_f = \\Delta H_{C+2H_2 \\rightarrow CH_4}$",
      "B) $\\Delta H_f = \\Delta H_{CO_2 + H_2O}$",
      "C) $\\Delta H_f = 0$",
      "D) $\\Delta H_f = \\Delta H_{H_2O}$"
    ],
    "correct": "A",
    "solution": "Hess‚Äôs law allows calculation of formation enthalpy using alternative reaction paths (combustion reactions).",
    "solution_steps": [
      "Step 1: Write formation reaction: $C + 2H_2 \\rightarrow CH_4$",
      "Step 2: Use combustion enthalpies of $C$ and $H_2$",
      "Step 3: Apply Hess‚Äôs law: sum of heats of intermediate reactions",
      "Step 4: Option A correct"
    ]
  },
  {
    "id": "q9_thermochemistry",
    "text": "The enthalpy change for the reaction $N_2 + 3 H_2 \\rightarrow 2 NH_3$ can be determined by Hess's law using:",
    "options": [
      "A) Formation enthalpies of $NH_3$, $N_2$, $H_2$",
      "B) Bond energies only",
      "C) Temperature and pressure",
      "D) Volume changes"
    ],
    "correct": "A",
    "solution": "Hess‚Äôs law allows calculation using standard enthalpies of formation of reactants and products.",
    "solution_steps": [
      "Step 1: Identify standard enthalpies of formation: $\\Delta H_f$ of $NH_3, N_2, H_2$",
      "Step 2: Apply Hess‚Äôs law: $\\Delta H = \\sum \\Delta H_f(products) - \\sum \\Delta H_f(reactants)$",
      "Step 3: Option A correct"
    ]
  },
  {
    "id": "q10_thermochemistry",
    "text": "A reaction has enthalpy change $\\Delta H_1 = 50$ kJ and another reaction $\\Delta H_2 = -30$ kJ. Combined reaction: $A + B \\rightarrow C + D$. The enthalpy change is:",
    "options": [
      "A) 20 kJ",
      "B) 80 kJ",
      "C) -80 kJ",
      "D) 0 kJ"
    ],
    "correct": "A",
    "solution": "Hess‚Äôs law: total enthalpy change = sum of enthalpies of steps: $50 + (-30) = 20$ kJ.",
    "solution_steps": [
      "Step 1: Apply Hess‚Äôs law: $\\Delta H = \\Delta H_1 + \\Delta H_2$",
      "Step 2: $50 + (-30) = 20$ kJ",
      "Step 3: Option A correct"
    ]
  },
  {
    "id": "q11_thermochemistry",
    "text": "Which of the following is an experimental verification of Hess's law?",
    "options": [
      "A) Using calorimeter to sum heats of intermediate reactions to match direct reaction",
      "B) Measuring pressure",
      "C) Measuring volume expansion",
      "D) Titration of acids"
    ],
    "correct": "A",
    "solution": "By measuring enthalpies of multiple reaction paths and verifying they sum to same total heat, Hess's law is confirmed.",
    "solution_steps": [
      "Step 1: Select a compound with multiple synthesis paths",
      "Step 2: Measure heat change along each path",
      "Step 3: Verify total enthalpy is same",
      "Step 4: Option A correct"
    ]
  },
  {
    "id": "q12_thermochemistry",
    "text": "Which is NOT an application of Hess‚Äôs law?",
    "options": [
      "A) Calculating enthalpy of formation",
      "B) Determining bond energies",
      "C) Calculating entropy change",
      "D) Predicting reaction enthalpies indirectly"
    ],
    "correct": "C",
    "solution": "Hess‚Äôs law applies to enthalpy changes, not directly to entropy changes.",
    "solution_steps": [
      "Step 1: Hess‚Äôs law: enthalpy change is state function",
      "Step 2: Does not calculate entropy directly",
      "Step 3: Option C correct"
    ]
  },
  {
    "id": "q13_thermochemistry",
    "text": "Which statement is true according to Levi-Osier and Laplace law?",
    "options": [
      "A) Heat absorbed in decomposition = heat released in formation (opposite sign)",
      "B) Heat absorbed in decomposition > heat released in formation",
      "C) Heat absorbed in decomposition < heat released in formation",
      "D) No relation between formation and decomposition heat"
    ],
    "correct": "A",
    "solution": "This is the core statement of Levi-Osier and Laplace law.",
    "solution_steps": [
      "Step 1: Formation reaction releases heat",
      "Step 2: Decomposition absorbs same amount",
      "Step 3: Option A correct"
    ]
  },
  {
    "id": "q14_thermochemistry",
    "text": "The standard enthalpy of formation of $H_2O(l)$ is -285.8 kJ/mol. Using Hess‚Äôs law, the enthalpy of formation of $H_2O(g)$ is -241.8 kJ/mol. The enthalpy of vaporization is:",
    "options": [
      "A) 44 kJ/mol",
      "B) -44 kJ/mol",
      "C) 526 kJ/mol",
      "D) 285.8 kJ/mol"
    ],
    "correct": "A",
    "solution": "Use Hess's law: $\\Delta H_{vap} = \\Delta H_f(H_2O(g)) - \\Delta H_f(H_2O(l)) = -241.8 - (-285.8) = 44$ kJ/mol",
    "solution_steps": [
      "Step 1: Identify enthalpies: $\\Delta H_f(H_2O(l)) = -285.8$, $\\Delta H_f(H_2O(g)) = -241.8$",
      "Step 2: $\\Delta H_{vap} = -241.8 - (-285.8) = 44$",
      "Step 3: Option A correct"
    ]
  },
  {
    "id": "q15_thermochemistry",
    "text": "The enthalpy of formation of $CO_2$ from $C$ and $O_2$ can be verified by Hess‚Äôs law using which of the following steps?",
    "options": [
      "A) $C + 1/2 O_2 \\rightarrow CO$, then $CO + 1/2 O_2 \\rightarrow CO_2$",
      "B) $C + O_2 \\rightarrow CO_2$ directly",
      "C) Combustion of methane",
      "D) Dissolution of CO2 in water"
    ],
    "correct": "A",
    "solution": "Hess‚Äôs law allows multi-step reaction enthalpies to sum to the overall reaction enthalpy.",
    "solution_steps": [
      "Step 1: Reaction 1: $C + 1/2 O_2 \\rightarrow CO$",
      "Step 2: Reaction 2: $CO + 1/2 O_2 \\rightarrow CO_2$",
      "Step 3: Sum enthalpies to get $\\Delta H_{C + O_2 \\rightarrow CO_2}$",
      "Step 4: Option A correct"
    ]
  }
]

;



let student = '';
let timerHandle;
let printMode = '';
let examDateTime = '';

const quizTitle = document.title.split("Quiz")[1]?.trim() || document.title;

function startQuiz() {
  const name = document.getElementById('studentNameInput').value.trim();
  if (!name) { alert('Please enter your name.'); return; }
  student = name;
  examDateTime = new Date().toLocaleString();
  document.getElementById('name-container').style.display = 'none';
  document.getElementById('quiz-container').style.display = 'block';
  buildQuestions();
  if (window.MathJax) MathJax.typesetPromise();
  startTimer();
}

function buildQuestions() {
  const out = document.getElementById('questions-container');
  out.innerHTML = '';

  Q.forEach((q, index) => {
    const qText = q.text || q.question || q.prompt || ''; // tolerate different keys

    // Normalize options into an ordered array of [letter, optionText]
    let entries = [];
    if (Array.isArray(q.options)) {
      entries = q.options.map((opt, i) => [String.fromCharCode(65 + i), opt]);
    } else if (q.options && typeof q.options === 'object') {
      const keys = Object.keys(q.options);
      const keysAreLetters = keys.every(k => /^[A-Z]$/.test(k));
      if (keysAreLetters) {
        keys.sort();
        entries = keys.map(k => [k, q.options[k]]);
      } else {
        entries = keys.map((k, i) => [String.fromCharCode(65 + i), q.options[k]]);
      }
    }

    const optionsHTML = entries.map(([letter, opt]) => {
      return `<label class="option-item" for="${q.id}-${letter}">
                <input type="radio" id="${q.id}-${letter}" name="${q.id}" value="${letter}" onchange="enableSubmit('${q.id}')">
                ${letter}. ${opt}
              </label>`;
    }).join('');

    const imageHTML = q.image ? `<div><img src="${q.image}" alt="figure" style="max-width:360px; margin:10px 0; display:block;"></div>` : '';

    // Handle solution steps if they exist
let solutionStepsHTML = '';
if (q.solution_steps && Array.isArray(q.solution_steps) && q.solution_steps.length > 0) {
  solutionStepsHTML = '<ul style="margin-top:10px;">' +
    q.solution_steps.map(step => {
      if (step.includes("\n")) {
        return `<li><pre style="background:#111; padding:6px; border-radius:4px; overflow-x:auto;">${step}</pre></li>`;
      }
      return `<li>${step}</li>`;
    }).join('') +
    '</ul>';
}


    out.insertAdjacentHTML('beforeend', `
      <div class="question" id="${q.id}-wrap">
        <h3>Q${index + 1}. ${qText}</h3>
        ${imageHTML}
        <div class="options">${optionsHTML}</div>
        <div id="${q.id}-buttons">
          <button id="sub-${q.id}" class="submit-button" disabled onclick="grade('${q.id}')">Submit</button>
          <button class="dontknow-button" onclick="skip('${q.id}')">I Don‚Äôt Know</button>
        </div>
        <button class="toggle-button" id="btn-sol-${q.id}" style="display:none;" onclick="toggleSolution('sol-${q.id}')">Show Solution</button>
        <div class="solution" id="sol-${q.id}">
          <strong>Solution:</strong> ${q.solution || ''} ${solutionStepsHTML}
        </div>
      </div>
    `);
  });

  if (window.MathJax && typeof MathJax.typesetPromise === 'function') MathJax.typesetPromise();
}



function enableSubmit(qid) { document.getElementById(`sub-${qid}`).disabled = false; }

function grade(qid) {
  const q = Q.find(x => x.id === qid);
  // accept different possible field names for the correct answer
  const correct = q.correct || q.answer || q.key || q.correctAnswer;
  const chosen = document.querySelector(`input[name="${qid}"]:checked`);
  if (!chosen) return;

  // lock options
  document.querySelectorAll(`input[name="${qid}"]`).forEach(i => i.disabled = true);

  // the chosen label
  const chosenLabel = chosen.closest('label.option-item');

  // find input that matches the correct letter
  const correctInput = document.querySelector(`input[name="${qid}"][value="${correct}"]`);
  const correctLabel = correctInput ? correctInput.closest('label.option-item') : null;

  if (chosen.value === correct) {
    // correct
    if (chosenLabel) {
      chosenLabel.style.background = '#28a745';
      chosenLabel.style.color = '#fff';
    }
  } else {
    // wrong: mark chosen red, mark correct green (if found)
    if (chosenLabel) {
      chosenLabel.style.background = '#dc3545';
      chosenLabel.style.color = '#fff';
    }
    if (correctLabel) {
      correctLabel.style.background = '#28a745';
      correctLabel.style.color = '#fff';
    }
  }

  // show solution immediately
  const solElem = document.getElementById(`sol-${qid}`);
  if (solElem) solElem.style.display = "block";

  // hide the buttons for this question
  const buttons = document.getElementById(`${qid}-buttons`);
  if (buttons) buttons.style.display = "none";
  const btnSol = document.getElementById(`btn-sol-${q.id}`);
  if (btnSol) btnSol.style.display = "none";

  // re-typeset MathJax for solution if it contains LaTeX
  if (window.MathJax && typeof MathJax.typesetPromise === 'function') MathJax.typesetPromise();
}


function skip(qid) { document.querySelectorAll(`input[name="${qid}"]`).forEach(r => r.disabled = true); showSolutionButton(qid); }
function showSolutionButton(qid) { document.getElementById(`btn-sol-${qid}`).style.display = 'inline-block'; document.getElementById(`${qid}-buttons`).style.display = 'none'; }
function toggleSolution(id) { const elem = document.getElementById(id); elem.style.display = elem.style.display === 'block' ? 'none' : 'block'; }

function startTimer() {
  const display = document.getElementById('timer');
  const started = Date.now();
  timerHandle = setInterval(() => { const s = Math.floor((Date.now() - started) / 1000); display.textContent = `${String((s / 60) | 0).padStart(2,'0')}:${String(s % 60).padStart(2,'0')}`; }, 1000);
}

function finalSubmit() {
  clearInterval(timerHandle);
  document.querySelectorAll("input[type=radio]").forEach(r => r.disabled = true);
  document.querySelectorAll(".submit-button, .dontknow-button").forEach(btn => btn.style.display = "none");

  let totalMarks = 0;
  let negativeMarks = 0;
  let possibleMarks = Q.length * 4;
  let detailHTML = '';

  Q.forEach((q, index) => {
    const checked = document.querySelector(`input[name="${q.id}"]:checked`);
    const chosen = checked ? checked.value : null;

    const correctLetter = q.correct || q.answer || q.key || q.correctAnswer;

    let marks = 0;
    let resultText = "";

    if (chosen === null) {
      marks = 0;
      resultText = "‚ö™ Not Attempted / I Don‚Äôt Know (0)";
    } else if (chosen === correctLetter) {
      marks = 4;
      resultText = "‚úÖ Correct (+4)";
    } else {
      marks = -1;
      resultText = "‚ùå Incorrect (-1)";
    }

    totalMarks += marks > 0 ? marks : 0;
    negativeMarks += marks < 0 ? marks : 0;

    let solutionStepsHTML = '';
    if (q.solution_steps && Array.isArray(q.solution_steps) && q.solution_steps.length > 0) {
      solutionStepsHTML = '<ul style="margin-top:5px;">' +
        q.solution_steps.map(step => `<li>${step}</li>`).join('') +
        '</ul>';
    }

    detailHTML += `
      <tr>
        <td>${index + 1}</td>
        <td>${q.text || q.question}</td>
        <td>${chosen || 'Not Answered'}</td>
        <td>${correctLetter}</td>
        <td>${resultText}</td>
        <td>${q.solution || ''}${solutionStepsHTML}</td>
        <td>${marks}</td>
      </tr>`;
  });

  const finalScore = totalMarks + negativeMarks;

  document.getElementById('scoreText').innerHTML = `${student}, here is your result:`;
  document.getElementById('scoreDetails').innerHTML = detailHTML;

  const summaryHTML = `
    <div style="margin-top:20px; font-weight:bold;">
      <p>Total Marks (Possible): ${possibleMarks}</p>
      <p>Total Marks (Correct Answers): ${totalMarks}</p>
      <p>Negative Marks (Wrong Answers): ${negativeMarks}</p>
      <p>Final Score: ${finalScore}</p>
    </div>
  `;
  document.getElementById('scorecard').insertAdjacentHTML('beforeend', summaryHTML);

  document.getElementById('scorecard').style.display = 'block';
  document.getElementById('printScoreBtn').style.display = 'inline-block';
  document.getElementById('shareWhatsappBtn').style.display = 'inline-block';

  if (window.MathJax && typeof MathJax.typesetPromise === 'function') MathJax.typesetPromise();
}






function printQuestions() { printMode = "questions"; window.print(); }
function printScorecard() { document.getElementById("studentPrintName").innerText = student; document.getElementById("examDateTime").innerText = "Exam Date & Time: " + examDateTime; printMode = "scorecard"; window.print(); }

window.addEventListener('beforeprint', () => {
  if (printMode === "questions") { document.querySelector("#questions-container").style.display = "block"; document.querySelector("#scorecard").style.display = "none"; document.querySelector("#logo").style.display = "none"; document.querySelector("#name-container").style.display = "none"; document.querySelector("#timer").style.display = "none"; document.querySelector("#studentPrintName").style.display = "none"; document.querySelector("#examDateTime").style.display = "none"; }
  if (printMode === "scorecard") { document.querySelector("#questions-container").style.display = "none"; document.querySelector("#scorecard").style.display = "block"; document.querySelector("#logo").style.display = "block"; document.querySelector("#name-container").style.display = "none"; document.querySelector("#studentPrintName").style.display = "block"; document.querySelector("#examDateTime").style.display = "block"; }
});
window.addEventListener('afterprint', () => { document.querySelector("#questions-container").style.display = ""; document.querySelector("#scorecard").style.display = ""; document.querySelector("#logo").style.display = ""; document.querySelector("#name-container").style.display = ""; document.querySelector("#timer").style.display = ""; document.querySelector("#studentPrintName").style.display = "none"; document.querySelector("#examDateTime").style.display = "none"; });




document.getElementById("shareWhatsappBtn").addEventListener("click", function () {
  const whatsappNumber = "9108069409455";

  if (!student) {
    alert("Please complete the quiz first.");
    return;
  }

  const scoreText = document.getElementById('scoreText').innerText || "Result not available";

  let totalMarks = 0;
  let negativeMarks = 0;
  let possibleMarks = Q.length * 4;

  let details = "";

  Q.forEach((q, i) => {
    const qNum = i + 1;
    const checked = document.querySelector(`input[name="${q.id}"]:checked`);
    let userAns = checked ? checked.value : null;
    const correctAns = q.correct || q.answer || q.key || q.correctAnswer;

    let marks = 0;
    let resultText = "";

    if (userAns === null) {
      marks = 0;
      resultText = "‚ö™ Not Attempted / I Don‚Äôt Know (0)";
      userAns = "Not Answered";
    } else if (userAns === correctAns) {
      marks = 4;
      resultText = "‚úÖ Correct (+4)";
    } else {
      marks = -1;
      resultText = "‚ùå Incorrect (-1)";
    }

    totalMarks += marks > 0 ? marks : 0;
    negativeMarks += marks < 0 ? marks : 0;

    details += `Q${qNum} ‚Üí ${resultText} (Your Ans: ${userAns} | Correct: ${correctAns})\n`;
  });

  const finalScore = totalMarks + negativeMarks;

  const message = `Sir, I have shared my Test Result for checking. Thank you!\n\nüìò Quiz Title: ${quizTitle}\nüë§ Student: ${student}\n\n${scoreText}\n\nüìä Summary:\n‚úî Total Marks (Possible): ${possibleMarks}\n‚úî Total Marks (Correct Answers): ${totalMarks}\n‚úî Negative Marks (Wrong Answers): ${negativeMarks}\n‚úî Final Score: ${finalScore}\n\nDetails:\n${details}`;

  const waUrl = `https://wa.me/${whatsappNumber}?text=${encodeURIComponent(message)}`;
  window.open(waUrl, "_blank");
});


const reportBtn = document.getElementById("reportBtn");
const reportModal = document.getElementById("reportModal");
const sendReport = document.getElementById("sendReport");
const closeReport = document.getElementById("closeReport");
const reportMsg = document.getElementById("reportMsg");

reportBtn.onclick = () => { reportModal.style.display = "block"; };
closeReport.onclick = () => { reportModal.style.display = "none"; reportMsg.value = ""; };
sendReport.onclick = () => {
  const msg = reportMsg.value.trim();
  if (!msg) { alert("Please write your message before sending."); return; }
  const whatsappNumber = "9108069409455";
  const message = `‚ö†Ô∏è Reported Mistake\n\nüìò Quiz Title: ${quizTitle}\nüë§ Student: ${student || "Anonymous"}\n\nüìù Message:\n${msg}`;
  const waUrl = `https://wa.me/${whatsappNumber}?text=${encodeURIComponent(message)}`;
  window.open(waUrl, "_blank");
  reportModal.style.display = "none";
  reportMsg.value = "";
};
</script>

</body>
</html>

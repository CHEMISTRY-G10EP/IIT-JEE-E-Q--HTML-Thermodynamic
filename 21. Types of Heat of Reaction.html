<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  
  
  <title> Quiz ‚Äì 21. Types of Heat of Reaction</title>
  
  
  <style>
    body{font-family:Arial, sans-serif;padding:20px;background:#121212;color:#f0f0f0;}
    #logo{display:block;margin:0 auto 25px;max-width:180px;}
    #name-container{background:#1e1e1e;padding:30px;border-radius:6px;max-width:420px;margin:0 auto;}
    #name-container input{width:100%;padding:10px;margin:10px 0 15px;border:none;border-radius:4px;font-size:16px;}
    #quiz-container{display:none;}
    .question{border:1px solid #333;padding:15px;margin-bottom:20px;border-radius:5px;background:#1e1e1e;}
    .question h3{margin:0 0 10px;}
    .option-item { display: flex; align-items: center; gap: 8px; margin: 6px 0; padding: 6px 8px; border-radius: 4px; background: #2a2a2a; color: #ccc; cursor: pointer; }
    .option-item input[type="radio"] { margin: 0; }
    .submit-button,.toggle-button,.dontknow-button{margin-top:10px;padding:6px 12px;background:#007BFF;color:#fff;border:none;border-radius:4px;cursor:pointer;margin-right:5px;}
    .solution{display:none;margin-top:10px;background:#2d2d2d;padding:10px;border-left:4px solid #28a745;}
    #scorecard{background:#2d2d2d;padding:15px;border-radius:6px;margin-top:30px;display:none;}
    #timer{font-weight:bold;color:#00ffcc;}
    #studentPrintName{text-align:center;font-size:18px;font-weight:bold;margin-top:-15px;margin-bottom:5px;display:none;}
    #examDateTime{text-align:center;font-size:14px;margin-bottom:20px;display:none;}
    @media print {
      body { background: #fff; color:#000; }
      .submit-button, .dontknow-button, .toggle-button, #reportBtn, #reportModal { display:none !important; }
      #name-container { display:none !important; }
    }
    #reportBtn { position: fixed; bottom: 20px; right: 20px; background: #ff4757; color: white; border: none; padding: 12px 18px; border-radius: 50px; cursor: pointer; font-weight: bold; box-shadow: 0px 4px 10px rgba(0,0,0,0.3); z-index: 1000; }
    #reportModal { display: none; position: fixed; bottom: 80px; right: 20px; background: #1e1e1e; border: 1px solid #444; padding: 15px; border-radius: 8px; width: 260px; z-index: 1001; }
    #reportModal textarea { width: 100%; height: 80px; padding: 8px; border: none; border-radius: 4px; resize: none; font-size: 14px; }
    #reportModal button { margin-top: 10px; padding: 8px 12px; border: none; border-radius: 4px; cursor: pointer; font-weight: bold; }
    #sendReport { background: #28a745; color: white; }
    #closeReport { background: #dc3545; color: white; margin-left: 5px; }
  </style>

  <!-- MathJax Configuration -->
  <script>
    window.MathJax = {
      tex: {
        inlineMath: [['\\(','\\)'], ['$', '$']], 
        displayMath: [['$$','$$'], ['\\[','\\]']],
        processEscapes: true
      },
      options: { skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre'] }
    };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>
<body>

<img id="logo" src="https://i.ibb.co/WNZTWPwv/LOGO-PNG-2025-fab.png" alt="Logo" />

<div id="studentPrintName"></div>
<div id="examDateTime"></div>

<div id="name-container">
  <h2>Enter your name to begin</h2>
  <input type="text" id="studentNameInput" placeholder="Your Name" />
  <button class="submit-button" onclick="startQuiz()">Start Quiz</button>
</div>

<div id="quiz-container">


  <h2> Quiz ‚Äì 21. Types of Heat of Reaction</h2>
  
  
  <p><strong>Time Elapsed:</strong> <span id="timer">00:00</span></p>
  <div id="questions-container"></div>

  <div style="margin-top:30px;">
    <button class="submit-button" onclick="finalSubmit()">Final Submit</button>
    <button class="submit-button" onclick="printQuestions()">Print Questions</button>
    <button class="submit-button" id="printScoreBtn" onclick="printScorecard()" style="display:none;">Save or Print Scorecard</button>
    <button class="submit-button" id="shareWhatsappBtn" style="display:none;">SHARE on WhatsApp</button>
  </div>

 <div id="scorecard">
  <h3>Your Scorecard</h3>
  <p id="scoreText"></p>
  <table id="scoreTable" border="1" cellspacing="0" cellpadding="6" style="width:100%;border-collapse:collapse;margin-top:15px;">
    <thead style="background:#333;color:#fff;">
      <tr>
        <th>Q.No</th>
        <th>Question</th>
        <th>Your Answer</th>
        <th>Correct Answer</th>
        <th>Result</th>
        <th>Solution</th>
      </tr>
    </thead>
    <tbody id="scoreDetails"></tbody>
  </table>
</div>

<button id="reportBtn">Report Mistake</button>

<div id="reportModal">
  <textarea id="reportMsg" placeholder="Describe the mistake..."></textarea>
  <div style="text-align:right;">
    <button id="sendReport">Send</button>
    <button id="closeReport">Close</button>
  </div>
</div>

<script>


const Q = [
  {
    "id": "q1_heat_type",
    "text": "The standard enthalpy of formation ($\\Delta H_f^\\circ$) of a compound is defined as:",
    "options": [
      "A) Heat change when 1 mole of compound is formed from its elements in standard states",
      "B) Heat change when 1 mole of compound is combusted completely",
      "C) Heat absorbed when 1 mole of solute dissolves in water",
      "D) Heat released when acid neutralizes a base"
    ],
    "correct": "A",
    "solution": "Standard enthalpy of formation is the enthalpy change for forming 1 mole of a compound from its elements in standard states.",
    "solution_steps": [
      "Step 1: Identify elements in standard states",
      "Step 2: Reaction should form 1 mole of compound",
      "Step 3: Option A correct"
    ]
  },
  {
    "id": "q2_heat_type",
    "text": "Heat of combustion of methane ($CH_4$) is $-890\\ \\mathrm{kJ/mol}$. This is the heat released when:",
    "options": [
      "A) 1 mole of CH4 reacts with O2 completely to give CO2 and H2O",
      "B) 1 mole of CH4 is formed from C(graphite) and H2",
      "C) 1 mole of CH4 dissolves in water",
      "D) 1 mole of CH4 neutralizes an acid"
    ],
    "correct": "A",
    "solution": "Combustion enthalpy is measured when 1 mole of substance reacts completely with oxygen.",
    "solution_steps": [
      "Step 1: Write reaction: $CH_4 + 2O_2 \\rightarrow CO_2 + 2H_2O$",
      "Step 2: Heat released = -890 kJ/mol",
      "Step 3: Option A correct"
    ]
  },
  {
    "id": "q3_heat_type",
    "text": "Calorific value of a fuel indicates:",
    "options": [
      "A) Heat released on complete combustion per gram of fuel",
      "B) Heat released on formation of 1 mole of fuel",
      "C) Heat absorbed in dissolving fuel in water",
      "D) Heat released on neutralization of fuel"
    ],
    "correct": "A",
    "solution": "Calorific value = energy released per gram or kg of fuel on complete combustion.",
    "solution_steps": [
      "Step 1: Measure heat released in bomb calorimeter",
      "Step 2: Divide by mass of fuel burned",
      "Step 3: Option A correct"
    ]
  },
  {
    "id": "q4_heat_type",
    "text": "Heat of neutralisation is defined as the heat evolved when:",
    "options": [
      "A) One mole of water is formed by reaction of an acid and a base",
      "B) One mole of HCl is formed",
      "C) One mole of NaOH is dissolved in water",
      "D) One mole of ionic solid dissolves in water"
    ],
    "correct": "A",
    "solution": "Neutralisation enthalpy = heat evolved per mole of water formed in acid-base reaction.",
    "solution_steps": [
      "Step 1: Reaction: $HCl + NaOH \\rightarrow NaCl + H_2O$",
      "Step 2: Heat released measured",
      "Step 3: Option A correct"
    ]
  },
  {
    "id": "q5_heat_type",
    "text": "Heat of solution is:",
    "options": [
      "A) Heat absorbed or evolved when one mole of solute dissolves in solvent",
      "B) Heat released when solute reacts with oxygen",
      "C) Heat absorbed in melting solute",
      "D) Heat released when solute reacts with acid"
    ],
    "correct": "A",
    "solution": "Heat of solution measures energy change on dissolving a mole of substance in solvent.",
    "solution_steps": [
      "Step 1: Dissolution reaction: $NaOH(s) \\rightarrow Na^+(aq) + OH^-(aq)$",
      "Step 2: Measure heat change ‚Üí heat of solution",
      "Step 3: Option A correct"
    ]
  },
  {
    "id": "q6_heat_type",
    "text": "Heat of hydration is the heat released when:",
    "options": [
      "A) 1 mole of gaseous ions dissolve in water to give aqueous ions",
      "B) 1 mole of solid melts",
      "C) 1 mole of compound is formed from elements",
      "D) 1 mole of acid neutralizes base"
    ],
    "correct": "A",
    "solution": "Hydration enthalpy = energy released when gaseous ions interact with water molecules.",
    "solution_steps": [
      "Step 1: $Na^+(g) + H_2O(l) \\rightarrow Na^+(aq)$",
      "Step 2: Measure heat released",
      "Step 3: Option A correct"
    ]
  },
  {
    "id": "q7_heat_type",
    "text": "Heat of vaporisation is defined as the heat required to convert:",
    "options": [
      "A) 1 mole of liquid to vapor at constant temperature and pressure",
      "B) 1 mole of vapor to liquid",
      "C) 1 mole of solid to liquid",
      "D) 1 mole of substance to ions in water"
    ],
    "correct": "A",
    "solution": "Heat of vaporisation = energy required to overcome intermolecular forces to convert liquid to gas.",
    "solution_steps": [
      "Step 1: $H_2O(l) \\rightarrow H_2O(g)$",
      "Step 2: Measure heat absorbed at 100¬∞C, 1 atm",
      "Step 3: Option A correct"
    ]
  },
  {
    "id": "q8_heat_type",
    "text": "Heat of fusion is:",
    "options": [
      "A) Heat required to convert 1 mole of solid to liquid at melting point",
      "B) Heat released when 1 mole of liquid freezes",
      "C) Heat of combustion",
      "D) Heat of formation"
    ],
    "correct": "A",
    "solution": "Heat of fusion = energy required to overcome lattice forces in solid to become liquid.",
    "solution_steps": [
      "Step 1: $H_2O(s) \\rightarrow H_2O(l)$ at 0¬∞C",
      "Step 2: Measure heat absorbed ‚Üí Option A correct"
    ]
  },
  {
    "id": "q9_heat_type",
    "text": "Heat of precipitation is:",
    "options": [
      "A) Heat change when 1 mole of solute precipitates from solution",
      "B) Heat released in combustion",
      "C) Heat of hydration",
      "D) Heat of fusion"
    ],
    "correct": "A",
    "solution": "When ions form insoluble salt, energy is released or absorbed ‚Üí heat of precipitation.",
    "solution_steps": [
      "Step 1: $Ag^+(aq) + Cl^-(aq) \\rightarrow AgCl(s)$",
      "Step 2: Measure heat released ‚Üí Option A correct"
    ]
  },
  {
    "id": "q10_heat_type",
    "text": "Heat of sublimation is defined as the heat required to convert:",
    "options": [
      "A) 1 mole of solid directly to gas at constant pressure",
      "B) 1 mole of solid to liquid",
      "C) 1 mole of liquid to gas",
      "D) 1 mole of solid to aqueous ions"
    ],
    "correct": "A",
    "solution": "Sublimation enthalpy = energy to overcome intermolecular forces from solid to gas.",
    "solution_steps": [
      "Step 1: $I_2(s) \\rightarrow I_2(g)$",
      "Step 2: Measure heat absorbed ‚Üí Option A correct"
    ]
  },
  {
    "id": "q11_heat_type",
    "text": "Heat of formation of $H_2O(l)$ from $H_2(g)$ and $O_2(g)$ is:",
    "options": [
      "A) $-285.8\\ \\mathrm{kJ/mol}$",
      "B) $+285.8\\ \\mathrm{kJ/mol}$",
      "C) Zero",
      "D) Cannot be determined"
    ],
    "correct": "A",
    "solution": "Reaction: $H_2(g) + 0.5 O_2(g) \\rightarrow H_2O(l)$ releases 285.8 kJ per mole.",
    "solution_steps": [
      "Step 1: Identify standard enthalpy of formation of H2O(l)",
      "Step 2: $\\Delta H_f^\\circ = -285.8\\ \\mathrm{kJ/mol}$",
      "Step 3: Option A correct"
    ]
  },
  {
    "id": "q12_heat_type",
    "text": "Heat of combustion of 1 mole of ethanol ($C_2H_5OH$) is:",
    "options": [
      "A) $-1367\\ \\mathrm{kJ/mol}$",
      "B) $-890\\ \\mathrm{kJ/mol}$",
      "C) $0\\ \\mathrm{kJ/mol}$",
      "D) $+1367\\ \\mathrm{kJ/mol}$"
    ],
    "correct": "A",
    "solution": "Reaction: $C_2H_5OH(l) + 3 O_2(g) \\rightarrow 2 CO_2(g) + 3 H_2O(l)$ releases 1367 kJ/mol.",
    "solution_steps": [
      "Step 1: Write combustion reaction of ethanol",
      "Step 2: Measure heat released ‚Üí -1367 kJ/mol",
      "Step 3: Option A correct"
    ]
  },
  {
    "id": "q13_heat_type",
    "text": "Heat of neutralisation for strong acid and strong base reaction is approximately:",
    "options": [
      "A) $-57.3\\ \\mathrm{kJ/mol}$",
      "B) $-40\\ \\mathrm{kJ/mol}$",
      "C) $0\\ \\mathrm{kJ/mol}$",
      "D) $+57.3\\ \\mathrm{kJ/mol}$"
    ],
    "correct": "A",
    "solution": "Reaction: $HCl + NaOH \\rightarrow NaCl + H_2O$ releases about 57.3 kJ per mole of water formed.",
    "solution_steps": [
      "Step 1: Recognize strong acid + strong base ‚Üí complete neutralization",
      "Step 2: Heat released ‚âà -57.3 kJ/mol",
      "Step 3: Option A correct"
    ]
  },
  {
    "id": "q14_heat_type",
    "text": "Heat of solution of $NaOH$ in water is:",
    "options": [
      "A) Exothermic",
      "B) Endothermic",
      "C) Zero",
      "D) Depends on concentration"
    ],
    "correct": "A",
    "solution": "NaOH dissolution releases heat due to hydration of ions ‚Üí exothermic.",
    "solution_steps": [
      "Step 1: $NaOH(s) \\rightarrow Na^+(aq) + OH^-(aq)$",
      "Step 2: Hydration releases energy",
      "Step 3: Option A correct"
    ]
  },
  {
    "id": "q15_heat_type",
    "text": "Heat of vaporisation of water at 100¬∞C is approximately:",
    "options": [
      "A) 40.7 kJ/mol",
      "B) 10 kJ/mol",
      "C) 286 kJ/mol",
      "D) 50 kJ/mol"
    ],
    "correct": "A",
    "solution": "Energy required to convert 1 mole of water at 100¬∞C to steam = 40.7 kJ/mol.",
    "solution_steps": [
      "Step 1: $H_2O(l) \\rightarrow H_2O(g)$ at 100¬∞C",
      "Step 2: Heat absorbed = 40.7 kJ/mol",
      "Step 3: Option A correct"
    ]
  },
  {
    "id": "q16_heat_type",
    "text": "Heat of fusion of ice at 0¬∞C is:",
    "options": [
      "A) 6.01 kJ/mol",
      "B) 40.7 kJ/mol",
      "C) 286 kJ/mol",
      "D) 0 kJ/mol"
    ],
    "correct": "A",
    "solution": "Energy required to melt 1 mole of ice at 0¬∞C ‚Üí 6.01 kJ/mol.",
    "solution_steps": [
      "Step 1: $H_2O(s) \\rightarrow H_2O(l)$ at 0¬∞C",
      "Step 2: Heat absorbed = 6.01 kJ/mol",
      "Step 3: Option A correct"
    ]
  },
  {
    "id": "q17_heat_type",
    "text": "Heat of precipitation for $AgCl$ formation is:",
    "options": [
      "A) Slightly exothermic",
      "B) Highly exothermic",
      "C) Endothermic",
      "D) Zero"
    ],
    "correct": "A",
    "solution": "Formation of $AgCl$ precipitate releases small amount of heat.",
    "solution_steps": [
      "Step 1: $Ag^+(aq) + Cl^-(aq) \\rightarrow AgCl(s)$",
      "Step 2: Measure heat released ‚Üí slightly exothermic",
      "Step 3: Option A correct"
    ]
  },
  {
    "id": "q18_heat_type",
    "text": "Heat of sublimation of iodine is:",
    "options": [
      "A) 62 kJ/mol",
      "B) 6 kJ/mol",
      "C) 286 kJ/mol",
      "D) 40.7 kJ/mol"
    ],
    "correct": "A",
    "solution": "Energy required to convert 1 mole of solid iodine to gas = 62 kJ/mol.",
    "solution_steps": [
      "Step 1: $I_2(s) \\rightarrow I_2(g)$",
      "Step 2: Heat absorbed = 62 kJ/mol",
      "Step 3: Option A correct"
    ]
  },
  {
    "id": "q19_heat_type",
    "text": "Standard enthalpy of formation of $CO_2(g)$ from graphite and oxygen is:",
    "options": [
      "A) -393.5 kJ/mol",
      "B) -110.5 kJ/mol",
      "C) 0 kJ/mol",
      "D) +393.5 kJ/mol"
    ],
    "correct": "A",
    "solution": "Reaction: $C(graphite) + O_2(g) \\rightarrow CO_2(g)$, heat released = -393.5 kJ/mol.",
    "solution_steps": [
      "Step 1: Identify reaction",
      "Step 2: Heat released = -393.5 kJ/mol",
      "Step 3: Option A correct"
    ]
  },
  {
    "id": "q20_heat_type",
    "text": "Heat of formation of $NH_3(g)$ from elements is:",
    "options": [
      "A) -46 kJ/mol",
      "B) -22 kJ/mol",
      "C) +46 kJ/mol",
      "D) 0 kJ/mol"
    ],
    "correct": "A",
    "solution": "Reaction: $N_2(g) + 3 H_2(g) \\rightarrow 2 NH_3(g)$, standard enthalpy of formation = -46 kJ/mol per mole of NH3.",
    "solution_steps": [
      "Step 1: Write formation reaction",
      "Step 2: Measure enthalpy change ‚Üí -46 kJ/mol",
      "Step 3: Option A correct"
    ]
  }
]

;



let student = '';
let timerHandle;
let printMode = '';
let examDateTime = '';

const quizTitle = document.title.split("Quiz")[1]?.trim() || document.title;

function startQuiz() {
  const name = document.getElementById('studentNameInput').value.trim();
  if (!name) { alert('Please enter your name.'); return; }
  student = name;
  examDateTime = new Date().toLocaleString();
  document.getElementById('name-container').style.display = 'none';
  document.getElementById('quiz-container').style.display = 'block';
  buildQuestions();
  if (window.MathJax) MathJax.typesetPromise();
  startTimer();
}

function buildQuestions() {
  const out = document.getElementById('questions-container');
  out.innerHTML = '';

  Q.forEach((q, index) => {
    const qText = q.text || q.question || q.prompt || ''; // tolerate different keys

    // Normalize options into an ordered array of [letter, optionText]
    let entries = [];
    if (Array.isArray(q.options)) {
      entries = q.options.map((opt, i) => [String.fromCharCode(65 + i), opt]);
    } else if (q.options && typeof q.options === 'object') {
      const keys = Object.keys(q.options);
      const keysAreLetters = keys.every(k => /^[A-Z]$/.test(k));
      if (keysAreLetters) {
        keys.sort();
        entries = keys.map(k => [k, q.options[k]]);
      } else {
        entries = keys.map((k, i) => [String.fromCharCode(65 + i), q.options[k]]);
      }
    }

    const optionsHTML = entries.map(([letter, opt]) => {
      return `<label class="option-item" for="${q.id}-${letter}">
                <input type="radio" id="${q.id}-${letter}" name="${q.id}" value="${letter}" onchange="enableSubmit('${q.id}')">
                ${letter}. ${opt}
              </label>`;
    }).join('');

    const imageHTML = q.image ? `<div><img src="${q.image}" alt="figure" style="max-width:360px; margin:10px 0; display:block;"></div>` : '';

    // Handle solution steps if they exist
let solutionStepsHTML = '';
if (q.solution_steps && Array.isArray(q.solution_steps) && q.solution_steps.length > 0) {
  solutionStepsHTML = '<ul style="margin-top:10px;">' +
    q.solution_steps.map(step => {
      if (step.includes("\n")) {
        return `<li><pre style="background:#111; padding:6px; border-radius:4px; overflow-x:auto;">${step}</pre></li>`;
      }
      return `<li>${step}</li>`;
    }).join('') +
    '</ul>';
}


    out.insertAdjacentHTML('beforeend', `
      <div class="question" id="${q.id}-wrap">
        <h3>Q${index + 1}. ${qText}</h3>
        ${imageHTML}
        <div class="options">${optionsHTML}</div>
        <div id="${q.id}-buttons">
          <button id="sub-${q.id}" class="submit-button" disabled onclick="grade('${q.id}')">Submit</button>
          <button class="dontknow-button" onclick="skip('${q.id}')">I Don‚Äôt Know</button>
        </div>
        <button class="toggle-button" id="btn-sol-${q.id}" style="display:none;" onclick="toggleSolution('sol-${q.id}')">Show Solution</button>
        <div class="solution" id="sol-${q.id}">
          <strong>Solution:</strong> ${q.solution || ''} ${solutionStepsHTML}
        </div>
      </div>
    `);
  });

  if (window.MathJax && typeof MathJax.typesetPromise === 'function') MathJax.typesetPromise();
}



function enableSubmit(qid) { document.getElementById(`sub-${qid}`).disabled = false; }

function grade(qid) {
  const q = Q.find(x => x.id === qid);
  // accept different possible field names for the correct answer
  const correct = q.correct || q.answer || q.key || q.correctAnswer;
  const chosen = document.querySelector(`input[name="${qid}"]:checked`);
  if (!chosen) return;

  // lock options
  document.querySelectorAll(`input[name="${qid}"]`).forEach(i => i.disabled = true);

  // the chosen label
  const chosenLabel = chosen.closest('label.option-item');

  // find input that matches the correct letter
  const correctInput = document.querySelector(`input[name="${qid}"][value="${correct}"]`);
  const correctLabel = correctInput ? correctInput.closest('label.option-item') : null;

  if (chosen.value === correct) {
    // correct
    if (chosenLabel) {
      chosenLabel.style.background = '#28a745';
      chosenLabel.style.color = '#fff';
    }
  } else {
    // wrong: mark chosen red, mark correct green (if found)
    if (chosenLabel) {
      chosenLabel.style.background = '#dc3545';
      chosenLabel.style.color = '#fff';
    }
    if (correctLabel) {
      correctLabel.style.background = '#28a745';
      correctLabel.style.color = '#fff';
    }
  }

  // show solution immediately
  const solElem = document.getElementById(`sol-${qid}`);
  if (solElem) solElem.style.display = "block";

  // hide the buttons for this question
  const buttons = document.getElementById(`${qid}-buttons`);
  if (buttons) buttons.style.display = "none";
  const btnSol = document.getElementById(`btn-sol-${q.id}`);
  if (btnSol) btnSol.style.display = "none";

  // re-typeset MathJax for solution if it contains LaTeX
  if (window.MathJax && typeof MathJax.typesetPromise === 'function') MathJax.typesetPromise();
}


function skip(qid) { document.querySelectorAll(`input[name="${qid}"]`).forEach(r => r.disabled = true); showSolutionButton(qid); }
function showSolutionButton(qid) { document.getElementById(`btn-sol-${qid}`).style.display = 'inline-block'; document.getElementById(`${qid}-buttons`).style.display = 'none'; }
function toggleSolution(id) { const elem = document.getElementById(id); elem.style.display = elem.style.display === 'block' ? 'none' : 'block'; }

function startTimer() {
  const display = document.getElementById('timer');
  const started = Date.now();
  timerHandle = setInterval(() => { const s = Math.floor((Date.now() - started) / 1000); display.textContent = `${String((s / 60) | 0).padStart(2,'0')}:${String(s % 60).padStart(2,'0')}`; }, 1000);
}

function finalSubmit() {
  clearInterval(timerHandle);
  document.querySelectorAll("input[type=radio]").forEach(r => r.disabled = true);
  document.querySelectorAll(".submit-button, .dontknow-button").forEach(btn => btn.style.display = "none");

  let totalMarks = 0;
  let negativeMarks = 0;
  let possibleMarks = Q.length * 4;
  let detailHTML = '';

  Q.forEach((q, index) => {
    const checked = document.querySelector(`input[name="${q.id}"]:checked`);
    const chosen = checked ? checked.value : null;

    const correctLetter = q.correct || q.answer || q.key || q.correctAnswer;

    let marks = 0;
    let resultText = "";

    if (chosen === null) {
      marks = 0;
      resultText = "‚ö™ Not Attempted / I Don‚Äôt Know (0)";
    } else if (chosen === correctLetter) {
      marks = 4;
      resultText = "‚úÖ Correct (+4)";
    } else {
      marks = -1;
      resultText = "‚ùå Incorrect (-1)";
    }

    totalMarks += marks > 0 ? marks : 0;
    negativeMarks += marks < 0 ? marks : 0;

    let solutionStepsHTML = '';
    if (q.solution_steps && Array.isArray(q.solution_steps) && q.solution_steps.length > 0) {
      solutionStepsHTML = '<ul style="margin-top:5px;">' +
        q.solution_steps.map(step => `<li>${step}</li>`).join('') +
        '</ul>';
    }

    detailHTML += `
      <tr>
        <td>${index + 1}</td>
        <td>${q.text || q.question}</td>
        <td>${chosen || 'Not Answered'}</td>
        <td>${correctLetter}</td>
        <td>${resultText}</td>
        <td>${q.solution || ''}${solutionStepsHTML}</td>
        <td>${marks}</td>
      </tr>`;
  });

  const finalScore = totalMarks + negativeMarks;

  document.getElementById('scoreText').innerHTML = `${student}, here is your result:`;
  document.getElementById('scoreDetails').innerHTML = detailHTML;

  const summaryHTML = `
    <div style="margin-top:20px; font-weight:bold;">
      <p>Total Marks (Possible): ${possibleMarks}</p>
      <p>Total Marks (Correct Answers): ${totalMarks}</p>
      <p>Negative Marks (Wrong Answers): ${negativeMarks}</p>
      <p>Final Score: ${finalScore}</p>
    </div>
  `;
  document.getElementById('scorecard').insertAdjacentHTML('beforeend', summaryHTML);

  document.getElementById('scorecard').style.display = 'block';
  document.getElementById('printScoreBtn').style.display = 'inline-block';
  document.getElementById('shareWhatsappBtn').style.display = 'inline-block';

  if (window.MathJax && typeof MathJax.typesetPromise === 'function') MathJax.typesetPromise();
}






function printQuestions() { printMode = "questions"; window.print(); }
function printScorecard() { document.getElementById("studentPrintName").innerText = student; document.getElementById("examDateTime").innerText = "Exam Date & Time: " + examDateTime; printMode = "scorecard"; window.print(); }

window.addEventListener('beforeprint', () => {
  if (printMode === "questions") { document.querySelector("#questions-container").style.display = "block"; document.querySelector("#scorecard").style.display = "none"; document.querySelector("#logo").style.display = "none"; document.querySelector("#name-container").style.display = "none"; document.querySelector("#timer").style.display = "none"; document.querySelector("#studentPrintName").style.display = "none"; document.querySelector("#examDateTime").style.display = "none"; }
  if (printMode === "scorecard") { document.querySelector("#questions-container").style.display = "none"; document.querySelector("#scorecard").style.display = "block"; document.querySelector("#logo").style.display = "block"; document.querySelector("#name-container").style.display = "none"; document.querySelector("#studentPrintName").style.display = "block"; document.querySelector("#examDateTime").style.display = "block"; }
});
window.addEventListener('afterprint', () => { document.querySelector("#questions-container").style.display = ""; document.querySelector("#scorecard").style.display = ""; document.querySelector("#logo").style.display = ""; document.querySelector("#name-container").style.display = ""; document.querySelector("#timer").style.display = ""; document.querySelector("#studentPrintName").style.display = "none"; document.querySelector("#examDateTime").style.display = "none"; });




document.getElementById("shareWhatsappBtn").addEventListener("click", function () {
  const whatsappNumber = "9108069409455";

  if (!student) {
    alert("Please complete the quiz first.");
    return;
  }

  const scoreText = document.getElementById('scoreText').innerText || "Result not available";

  let totalMarks = 0;
  let negativeMarks = 0;
  let possibleMarks = Q.length * 4;

  let details = "";

  Q.forEach((q, i) => {
    const qNum = i + 1;
    const checked = document.querySelector(`input[name="${q.id}"]:checked`);
    let userAns = checked ? checked.value : null;
    const correctAns = q.correct || q.answer || q.key || q.correctAnswer;

    let marks = 0;
    let resultText = "";

    if (userAns === null) {
      marks = 0;
      resultText = "‚ö™ Not Attempted / I Don‚Äôt Know (0)";
      userAns = "Not Answered";
    } else if (userAns === correctAns) {
      marks = 4;
      resultText = "‚úÖ Correct (+4)";
    } else {
      marks = -1;
      resultText = "‚ùå Incorrect (-1)";
    }

    totalMarks += marks > 0 ? marks : 0;
    negativeMarks += marks < 0 ? marks : 0;

    details += `Q${qNum} ‚Üí ${resultText} (Your Ans: ${userAns} | Correct: ${correctAns})\n`;
  });

  const finalScore = totalMarks + negativeMarks;

  const message = `Sir, I have shared my Test Result for checking. Thank you!\n\nüìò Quiz Title: ${quizTitle}\nüë§ Student: ${student}\n\n${scoreText}\n\nüìä Summary:\n‚úî Total Marks (Possible): ${possibleMarks}\n‚úî Total Marks (Correct Answers): ${totalMarks}\n‚úî Negative Marks (Wrong Answers): ${negativeMarks}\n‚úî Final Score: ${finalScore}\n\nDetails:\n${details}`;

  const waUrl = `https://wa.me/${whatsappNumber}?text=${encodeURIComponent(message)}`;
  window.open(waUrl, "_blank");
});


const reportBtn = document.getElementById("reportBtn");
const reportModal = document.getElementById("reportModal");
const sendReport = document.getElementById("sendReport");
const closeReport = document.getElementById("closeReport");
const reportMsg = document.getElementById("reportMsg");

reportBtn.onclick = () => { reportModal.style.display = "block"; };
closeReport.onclick = () => { reportModal.style.display = "none"; reportMsg.value = ""; };
sendReport.onclick = () => {
  const msg = reportMsg.value.trim();
  if (!msg) { alert("Please write your message before sending."); return; }
  const whatsappNumber = "9108069409455";
  const message = `‚ö†Ô∏è Reported Mistake\n\nüìò Quiz Title: ${quizTitle}\nüë§ Student: ${student || "Anonymous"}\n\nüìù Message:\n${msg}`;
  const waUrl = `https://wa.me/${whatsappNumber}?text=${encodeURIComponent(message)}`;
  window.open(waUrl, "_blank");
  reportModal.style.display = "none";
  reportMsg.value = "";
};
</script>

</body>
</html>

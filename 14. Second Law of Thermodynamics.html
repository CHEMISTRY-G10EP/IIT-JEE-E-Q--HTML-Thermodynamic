<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  
  
  <title> Quiz ‚Äì 14. Second Law of Thermodynamics</title>
  
  
  <style>
    body{font-family:Arial, sans-serif;padding:20px;background:#121212;color:#f0f0f0;}
    #logo{display:block;margin:0 auto 25px;max-width:180px;}
    #name-container{background:#1e1e1e;padding:30px;border-radius:6px;max-width:420px;margin:0 auto;}
    #name-container input{width:100%;padding:10px;margin:10px 0 15px;border:none;border-radius:4px;font-size:16px;}
    #quiz-container{display:none;}
    .question{border:1px solid #333;padding:15px;margin-bottom:20px;border-radius:5px;background:#1e1e1e;}
    .question h3{margin:0 0 10px;}
    .option-item { display: flex; align-items: center; gap: 8px; margin: 6px 0; padding: 6px 8px; border-radius: 4px; background: #2a2a2a; color: #ccc; cursor: pointer; }
    .option-item input[type="radio"] { margin: 0; }
    .submit-button,.toggle-button,.dontknow-button{margin-top:10px;padding:6px 12px;background:#007BFF;color:#fff;border:none;border-radius:4px;cursor:pointer;margin-right:5px;}
    .solution{display:none;margin-top:10px;background:#2d2d2d;padding:10px;border-left:4px solid #28a745;}
    #scorecard{background:#2d2d2d;padding:15px;border-radius:6px;margin-top:30px;display:none;}
    #timer{font-weight:bold;color:#00ffcc;}
    #studentPrintName{text-align:center;font-size:18px;font-weight:bold;margin-top:-15px;margin-bottom:5px;display:none;}
    #examDateTime{text-align:center;font-size:14px;margin-bottom:20px;display:none;}
    @media print {
      body { background: #fff; color:#000; }
      .submit-button, .dontknow-button, .toggle-button, #reportBtn, #reportModal { display:none !important; }
      #name-container { display:none !important; }
    }
    #reportBtn { position: fixed; bottom: 20px; right: 20px; background: #ff4757; color: white; border: none; padding: 12px 18px; border-radius: 50px; cursor: pointer; font-weight: bold; box-shadow: 0px 4px 10px rgba(0,0,0,0.3); z-index: 1000; }
    #reportModal { display: none; position: fixed; bottom: 80px; right: 20px; background: #1e1e1e; border: 1px solid #444; padding: 15px; border-radius: 8px; width: 260px; z-index: 1001; }
    #reportModal textarea { width: 100%; height: 80px; padding: 8px; border: none; border-radius: 4px; resize: none; font-size: 14px; }
    #reportModal button { margin-top: 10px; padding: 8px 12px; border: none; border-radius: 4px; cursor: pointer; font-weight: bold; }
    #sendReport { background: #28a745; color: white; }
    #closeReport { background: #dc3545; color: white; margin-left: 5px; }
  </style>

  <!-- MathJax Configuration -->
  <script>
    window.MathJax = {
      tex: {
        inlineMath: [['\\(','\\)'], ['$', '$']], 
        displayMath: [['$$','$$'], ['\\[','\\]']],
        processEscapes: true
      },
      options: { skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre'] }
    };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>
<body>

<img id="logo" src="https://i.ibb.co/WNZTWPwv/LOGO-PNG-2025-fab.png" alt="Logo" />

<div id="studentPrintName"></div>
<div id="examDateTime"></div>

<div id="name-container">
  <h2>Enter your name to begin</h2>
  <input type="text" id="studentNameInput" placeholder="Your Name" />
  <button class="submit-button" onclick="startQuiz()">Start Quiz</button>
</div>

<div id="quiz-container">


  <h2> Quiz ‚Äì 14. Second Law of Thermodynamics</h2>
  
  
  <p><strong>Time Elapsed:</strong> <span id="timer">00:00</span></p>
  <div id="questions-container"></div>

  <div style="margin-top:30px;">
    <button class="submit-button" onclick="finalSubmit()">Final Submit</button>
    <button class="submit-button" onclick="printQuestions()">Print Questions</button>
    <button class="submit-button" id="printScoreBtn" onclick="printScorecard()" style="display:none;">Save or Print Scorecard</button>
    <button class="submit-button" id="shareWhatsappBtn" style="display:none;">SHARE on WhatsApp</button>
  </div>

 <div id="scorecard">
  <h3>Your Scorecard</h3>
  <p id="scoreText"></p>
  <table id="scoreTable" border="1" cellspacing="0" cellpadding="6" style="width:100%;border-collapse:collapse;margin-top:15px;">
    <thead style="background:#333;color:#fff;">
      <tr>
        <th>Q.No</th>
        <th>Question</th>
        <th>Your Answer</th>
        <th>Correct Answer</th>
        <th>Result</th>
        <th>Solution</th>
      </tr>
    </thead>
    <tbody id="scoreDetails"></tbody>
  </table>
</div>

<button id="reportBtn">Report Mistake</button>

<div id="reportModal">
  <textarea id="reportMsg" placeholder="Describe the mistake..."></textarea>
  <div style="text-align:right;">
    <button id="sendReport">Send</button>
    <button id="closeReport">Close</button>
  </div>
</div>

<script>


const Q = [
  {
    "id": "q1_secondlaw",
    "text": "Which of the following is a statement of the Second Law of Thermodynamics?",
    "options": [
      "A) Heat cannot spontaneously flow from a colder body to a hotter body",
      "B) Energy cannot be created or destroyed",
      "C) Total entropy of an isolated system can decrease",
      "D) Work is always equal to heat absorbed"
    ],
    "correct": "A",
    "solution": "This is the Clausius statement of the second law: heat flows spontaneously from hot to cold.",
    "solution_steps": [
      "Step 1: Clausius statement: heat cannot flow spontaneously from cold to hot",
      "Step 2: Option A correctly expresses this law"
    ]
  },
  {
    "id": "q2_secondlaw",
    "text": "The Kelvin-Planck statement of the second law says:",
    "options": [
      "A) It is impossible to construct an engine that absorbs heat from a single reservoir and converts it completely into work",
      "B) Energy can be created by a perpetual motion machine of first kind",
      "C) Heat always flows from hot to cold spontaneously",
      "D) Entropy of the universe can decrease"
    ],
    "correct": "A",
    "solution": "Kelvin-Planck statement emphasizes impossibility of 100% efficient heat-to-work conversion from a single heat reservoir.",
    "solution_steps": [
      "Step 1: Kelvin-Planck: no engine can convert all heat from a single reservoir into work",
      "Step 2: Option A correctly states this"
    ]
  },
  {
    "id": "q3_secondlaw",
    "text": "Which of the following is an example of the Clausius statement?",
    "options": [
      "A) Refrigerator transferring heat from cold to hot with external work",
      "B) A frictionless pendulum oscillating indefinitely",
      "C) Heat engine operating between two reservoirs with 100% efficiency",
      "D) Isothermal expansion of gas doing work"
    ],
    "correct": "A",
    "solution": "Clausius statement: heat cannot flow spontaneously from cold to hot, but work input can achieve this (refrigerator).",
    "solution_steps": [
      "Step 1: Spontaneous heat flow cannot go cold‚Üíhot",
      "Step 2: Option A shows work-assisted heat transfer ‚Üí valid Clausius example"
    ]
  },
  {
    "id": "q4_secondlaw",
    "text": "According to Ostwald's statement of the second law, which of the following is correct?",
    "options": [
      "A) No heat engine can have 100% conversion of heat into work",
      "B) Heat always flows from hot to cold",
      "C) Energy is always conserved",
      "D) Entropy of the universe can decrease"
    ],
    "correct": "A",
    "solution": "Ostwald‚Äôs statement emphasizes impossibility of total conversion of heat into work.",
    "solution_steps": [
      "Step 1: Ostwald statement: 100% conversion of heat to work is impossible",
      "Step 2: Option A matches this principle"
    ]
  },
  {
    "id": "q5_secondlaw",
    "text": "Which statement explains why Carnot engine sets the maximum efficiency?",
    "options": [
      "A) Because it is a reversible engine operating between two temperatures",
      "B) Because it is irreversible",
      "C) Because it uses a perfect conductor",
      "D) Because it absorbs no heat"
    ],
    "correct": "A",
    "solution": "Carnot engine is reversible; efficiency depends only on temperatures of reservoirs.",
    "solution_steps": [
      "Step 1: Carnot cycle is reversible",
      "Step 2: Maximum efficiency depends on $T_H$ and $T_C$",
      "Step 3: Option A correct"
    ]
  },
  {
    "id": "q6_secondlaw",
    "text": "Entropy change of an isolated system in a spontaneous process is:",
    "options": [
      "A) Positive",
      "B) Negative",
      "C) Zero",
      "D) Infinite"
    ],
    "correct": "A",
    "solution": "Second law implies entropy of isolated system increases in spontaneous process.",
    "solution_steps": [
      "Step 1: Second law: $\\Delta S_{universe} > 0$ for spontaneous processes",
      "Step 2: Option A correct"
    ]
  },
  {
    "id": "q7_secondlaw",
    "text": "Which process violates the Kelvin-Planck statement?",
    "options": [
      "A) Engine absorbs 500 J from a single heat reservoir and does 500 J of work",
      "B) Engine absorbs 500 J and rejects 250 J, producing 250 J work",
      "C) Refrigeration cycle removing heat from cold to hot",
      "D) Adiabatic free expansion of gas"
    ],
    "correct": "A",
    "solution": "Kelvin-Planck forbids complete conversion of heat from one reservoir into work.",
    "solution_steps": [
      "Step 1: Engine absorbs heat from one reservoir",
      "Step 2: Converts all heat into work",
      "Step 3: Violates Kelvin-Planck ‚Üí Option A correct"
    ]
  },
  {
    "id": "q8_secondlaw",
    "text": "Proof of the second law can be established using:",
    "options": [
      "A) Carnot engine and Carnot theorem",
      "B) Boyle‚Äôs law",
      "C) Charles‚Äôs law",
      "D) Ideal gas law only"
    ],
    "correct": "A",
    "solution": "Using Carnot theorem, it can be shown no engine is more efficient than a reversible engine ‚Üí establishes second law.",
    "solution_steps": [
      "Step 1: Consider reversible and irreversible engines",
      "Step 2: Use Carnot theorem to prove efficiency limits",
      "Step 3: Option A correct"
    ]
  },
  {
    "id": "q9_secondlaw",
    "text": "Which of the following represents a reversible process for entropy change?",
    "options": [
      "A) Carnot cycle",
      "B) Free expansion of gas",
      "C) Mixing of gases spontaneously",
      "D) Heat flow from hot to cold without work"
    ],
    "correct": "A",
    "solution": "Reversible processes have zero net entropy change of universe; Carnot cycle is ideal reversible process.",
    "solution_steps": [
      "Step 1: Reversible ‚Üí $\\Delta S_{universe} = 0$",
      "Step 2: Carnot cycle satisfies this ‚Üí Option A correct"
    ]
  },
  {
    "id": "q10_secondlaw",
    "text": "Which of the following is a Clausius proof of the second law?",
    "options": [
      "A) No engine can transfer heat from cold to hot without external work",
      "B) Work can be fully converted to heat",
      "C) Gas expands freely without heat transfer",
      "D) Energy can be created"
    ],
    "correct": "A",
    "solution": "Clausius proof: heat cannot spontaneously go from cold to hot; work may be required.",
    "solution_steps": [
      "Step 1: Clausius statement: cold‚Üíhot requires work",
      "Step 2: Option A correct"
    ]
  },
  {
    "id": "q11_secondlaw",
    "text": "Which of the following is not a statement of second law?",
    "options": [
      "A) First law of thermodynamics",
      "B) Kelvin statement",
      "C) Clausius statement",
      "D) Ostwald statement"
    ],
    "correct": "A",
    "solution": "First law is about conservation of energy, not second law.",
    "solution_steps": [
      "Step 1: Identify statements of second law",
      "Step 2: First law deals with energy conservation ‚Üí Option A correct"
    ]
  },
  {
    "id": "q12_secondlaw",
    "text": "Entropy change for reversible isothermal expansion of an ideal gas is given by:",
    "options": [
      "A) $\\Delta S = nR \\ln(V_f/V_i)$",
      "B) $\\Delta S = 0$",
      "C) $\\Delta S = nC_V \\Delta T$",
      "D) $\\Delta S = -nR \\ln(V_f/V_i)$"
    ],
    "correct": "A",
    "solution": "For isothermal reversible expansion: $\\Delta S = \\int dQ_{rev}/T = nR \\ln(V_f/V_i)$",
    "solution_steps": [
      "Step 1: Isothermal ‚Üí $\\Delta U = 0$",
      "Step 2: $dQ_{rev} = PdV = nRT dV/V$",
      "Step 3: Integrate: $\\Delta S = nR \\ln(V_f/V_i)$ ‚Üí Option A correct"
    ]
  },
  {
    "id": "q13_secondlaw",
    "text": "For a reversible cyclic engine, the net entropy change of universe is:",
    "options": [
      "A) Zero",
      "B) Positive",
      "C) Negative",
      "D) Infinite"
    ],
    "correct": "A",
    "solution": "Reversible cyclic processes do not produce net entropy change.",
    "solution_steps": [
      "Step 1: Reversible ‚Üí $\\Delta S_{universe} = 0$",
      "Step 2: Option A correct"
    ]
  },
  {
    "id": "q14_secondlaw",
    "text": "Which of the following is true for an irreversible process?",
    "options": [
      "A) Entropy of universe increases",
      "B) Entropy of universe decreases",
      "C) Entropy remains constant",
      "D) Work output equals heat absorbed"
    ],
    "correct": "A",
    "solution": "Irreversible processes increase total entropy of universe.",
    "solution_steps": [
      "Step 1: Irreversible ‚Üí $\\Delta S_{universe} > 0$",
      "Step 2: Option A correct"
    ]
  },
  {
    "id": "q15_secondlaw",
    "text": "Which of the following demonstrates proof of second law using Carnot engine?",
    "options": [
      "A) No engine can be more efficient than a reversible Carnot engine",
      "B) Free expansion of gas is reversible",
      "C) Heat flows spontaneously from cold to hot",
      "D) Work can be fully converted to heat"
    ],
    "correct": "A",
    "solution": "Carnot theorem proves that efficiency of any engine ‚â§ reversible Carnot engine.",
    "solution_steps": [
      "Step 1: Compare reversible and irreversible engines",
      "Step 2: Efficiency of irreversible ‚â§ reversible",
      "Step 3: Option A correct"
    ]
  }
]

;



let student = '';
let timerHandle;
let printMode = '';
let examDateTime = '';

const quizTitle = document.title.split("Quiz")[1]?.trim() || document.title;

function startQuiz() {
  const name = document.getElementById('studentNameInput').value.trim();
  if (!name) { alert('Please enter your name.'); return; }
  student = name;
  examDateTime = new Date().toLocaleString();
  document.getElementById('name-container').style.display = 'none';
  document.getElementById('quiz-container').style.display = 'block';
  buildQuestions();
  if (window.MathJax) MathJax.typesetPromise();
  startTimer();
}

function buildQuestions() {
  const out = document.getElementById('questions-container');
  out.innerHTML = '';

  Q.forEach((q, index) => {
    const qText = q.text || q.question || q.prompt || ''; // tolerate different keys

    // Normalize options into an ordered array of [letter, optionText]
    let entries = [];
    if (Array.isArray(q.options)) {
      entries = q.options.map((opt, i) => [String.fromCharCode(65 + i), opt]);
    } else if (q.options && typeof q.options === 'object') {
      const keys = Object.keys(q.options);
      const keysAreLetters = keys.every(k => /^[A-Z]$/.test(k));
      if (keysAreLetters) {
        keys.sort();
        entries = keys.map(k => [k, q.options[k]]);
      } else {
        entries = keys.map((k, i) => [String.fromCharCode(65 + i), q.options[k]]);
      }
    }

    const optionsHTML = entries.map(([letter, opt]) => {
      return `<label class="option-item" for="${q.id}-${letter}">
                <input type="radio" id="${q.id}-${letter}" name="${q.id}" value="${letter}" onchange="enableSubmit('${q.id}')">
                ${letter}. ${opt}
              </label>`;
    }).join('');

    const imageHTML = q.image ? `<div><img src="${q.image}" alt="figure" style="max-width:360px; margin:10px 0; display:block;"></div>` : '';

    // Handle solution steps if they exist
let solutionStepsHTML = '';
if (q.solution_steps && Array.isArray(q.solution_steps) && q.solution_steps.length > 0) {
  solutionStepsHTML = '<ul style="margin-top:10px;">' +
    q.solution_steps.map(step => {
      if (step.includes("\n")) {
        return `<li><pre style="background:#111; padding:6px; border-radius:4px; overflow-x:auto;">${step}</pre></li>`;
      }
      return `<li>${step}</li>`;
    }).join('') +
    '</ul>';
}


    out.insertAdjacentHTML('beforeend', `
      <div class="question" id="${q.id}-wrap">
        <h3>Q${index + 1}. ${qText}</h3>
        ${imageHTML}
        <div class="options">${optionsHTML}</div>
        <div id="${q.id}-buttons">
          <button id="sub-${q.id}" class="submit-button" disabled onclick="grade('${q.id}')">Submit</button>
          <button class="dontknow-button" onclick="skip('${q.id}')">I Don‚Äôt Know</button>
        </div>
        <button class="toggle-button" id="btn-sol-${q.id}" style="display:none;" onclick="toggleSolution('sol-${q.id}')">Show Solution</button>
        <div class="solution" id="sol-${q.id}">
          <strong>Solution:</strong> ${q.solution || ''} ${solutionStepsHTML}
        </div>
      </div>
    `);
  });

  if (window.MathJax && typeof MathJax.typesetPromise === 'function') MathJax.typesetPromise();
}



function enableSubmit(qid) { document.getElementById(`sub-${qid}`).disabled = false; }

function grade(qid) {
  const q = Q.find(x => x.id === qid);
  // accept different possible field names for the correct answer
  const correct = q.correct || q.answer || q.key || q.correctAnswer;
  const chosen = document.querySelector(`input[name="${qid}"]:checked`);
  if (!chosen) return;

  // lock options
  document.querySelectorAll(`input[name="${qid}"]`).forEach(i => i.disabled = true);

  // the chosen label
  const chosenLabel = chosen.closest('label.option-item');

  // find input that matches the correct letter
  const correctInput = document.querySelector(`input[name="${qid}"][value="${correct}"]`);
  const correctLabel = correctInput ? correctInput.closest('label.option-item') : null;

  if (chosen.value === correct) {
    // correct
    if (chosenLabel) {
      chosenLabel.style.background = '#28a745';
      chosenLabel.style.color = '#fff';
    }
  } else {
    // wrong: mark chosen red, mark correct green (if found)
    if (chosenLabel) {
      chosenLabel.style.background = '#dc3545';
      chosenLabel.style.color = '#fff';
    }
    if (correctLabel) {
      correctLabel.style.background = '#28a745';
      correctLabel.style.color = '#fff';
    }
  }

  // show solution immediately
  const solElem = document.getElementById(`sol-${qid}`);
  if (solElem) solElem.style.display = "block";

  // hide the buttons for this question
  const buttons = document.getElementById(`${qid}-buttons`);
  if (buttons) buttons.style.display = "none";
  const btnSol = document.getElementById(`btn-sol-${q.id}`);
  if (btnSol) btnSol.style.display = "none";

  // re-typeset MathJax for solution if it contains LaTeX
  if (window.MathJax && typeof MathJax.typesetPromise === 'function') MathJax.typesetPromise();
}


function skip(qid) { document.querySelectorAll(`input[name="${qid}"]`).forEach(r => r.disabled = true); showSolutionButton(qid); }
function showSolutionButton(qid) { document.getElementById(`btn-sol-${qid}`).style.display = 'inline-block'; document.getElementById(`${qid}-buttons`).style.display = 'none'; }
function toggleSolution(id) { const elem = document.getElementById(id); elem.style.display = elem.style.display === 'block' ? 'none' : 'block'; }

function startTimer() {
  const display = document.getElementById('timer');
  const started = Date.now();
  timerHandle = setInterval(() => { const s = Math.floor((Date.now() - started) / 1000); display.textContent = `${String((s / 60) | 0).padStart(2,'0')}:${String(s % 60).padStart(2,'0')}`; }, 1000);
}

function finalSubmit() {
  clearInterval(timerHandle);
  document.querySelectorAll("input[type=radio]").forEach(r => r.disabled = true);
  document.querySelectorAll(".submit-button, .dontknow-button").forEach(btn => btn.style.display = "none");

  let totalMarks = 0;
  let negativeMarks = 0;
  let possibleMarks = Q.length * 4;
  let detailHTML = '';

  Q.forEach((q, index) => {
    const checked = document.querySelector(`input[name="${q.id}"]:checked`);
    const chosen = checked ? checked.value : null;

    const correctLetter = q.correct || q.answer || q.key || q.correctAnswer;

    let marks = 0;
    let resultText = "";

    if (chosen === null) {
      marks = 0;
      resultText = "‚ö™ Not Attempted / I Don‚Äôt Know (0)";
    } else if (chosen === correctLetter) {
      marks = 4;
      resultText = "‚úÖ Correct (+4)";
    } else {
      marks = -1;
      resultText = "‚ùå Incorrect (-1)";
    }

    totalMarks += marks > 0 ? marks : 0;
    negativeMarks += marks < 0 ? marks : 0;

    let solutionStepsHTML = '';
    if (q.solution_steps && Array.isArray(q.solution_steps) && q.solution_steps.length > 0) {
      solutionStepsHTML = '<ul style="margin-top:5px;">' +
        q.solution_steps.map(step => `<li>${step}</li>`).join('') +
        '</ul>';
    }

    detailHTML += `
      <tr>
        <td>${index + 1}</td>
        <td>${q.text || q.question}</td>
        <td>${chosen || 'Not Answered'}</td>
        <td>${correctLetter}</td>
        <td>${resultText}</td>
        <td>${q.solution || ''}${solutionStepsHTML}</td>
        <td>${marks}</td>
      </tr>`;
  });

  const finalScore = totalMarks + negativeMarks;

  document.getElementById('scoreText').innerHTML = `${student}, here is your result:`;
  document.getElementById('scoreDetails').innerHTML = detailHTML;

  const summaryHTML = `
    <div style="margin-top:20px; font-weight:bold;">
      <p>Total Marks (Possible): ${possibleMarks}</p>
      <p>Total Marks (Correct Answers): ${totalMarks}</p>
      <p>Negative Marks (Wrong Answers): ${negativeMarks}</p>
      <p>Final Score: ${finalScore}</p>
    </div>
  `;
  document.getElementById('scorecard').insertAdjacentHTML('beforeend', summaryHTML);

  document.getElementById('scorecard').style.display = 'block';
  document.getElementById('printScoreBtn').style.display = 'inline-block';
  document.getElementById('shareWhatsappBtn').style.display = 'inline-block';

  if (window.MathJax && typeof MathJax.typesetPromise === 'function') MathJax.typesetPromise();
}






function printQuestions() { printMode = "questions"; window.print(); }
function printScorecard() { document.getElementById("studentPrintName").innerText = student; document.getElementById("examDateTime").innerText = "Exam Date & Time: " + examDateTime; printMode = "scorecard"; window.print(); }

window.addEventListener('beforeprint', () => {
  if (printMode === "questions") { document.querySelector("#questions-container").style.display = "block"; document.querySelector("#scorecard").style.display = "none"; document.querySelector("#logo").style.display = "none"; document.querySelector("#name-container").style.display = "none"; document.querySelector("#timer").style.display = "none"; document.querySelector("#studentPrintName").style.display = "none"; document.querySelector("#examDateTime").style.display = "none"; }
  if (printMode === "scorecard") { document.querySelector("#questions-container").style.display = "none"; document.querySelector("#scorecard").style.display = "block"; document.querySelector("#logo").style.display = "block"; document.querySelector("#name-container").style.display = "none"; document.querySelector("#studentPrintName").style.display = "block"; document.querySelector("#examDateTime").style.display = "block"; }
});
window.addEventListener('afterprint', () => { document.querySelector("#questions-container").style.display = ""; document.querySelector("#scorecard").style.display = ""; document.querySelector("#logo").style.display = ""; document.querySelector("#name-container").style.display = ""; document.querySelector("#timer").style.display = ""; document.querySelector("#studentPrintName").style.display = "none"; document.querySelector("#examDateTime").style.display = "none"; });




document.getElementById("shareWhatsappBtn").addEventListener("click", function () {
  const whatsappNumber = "9108069409455";

  if (!student) {
    alert("Please complete the quiz first.");
    return;
  }

  const scoreText = document.getElementById('scoreText').innerText || "Result not available";

  let totalMarks = 0;
  let negativeMarks = 0;
  let possibleMarks = Q.length * 4;

  let details = "";

  Q.forEach((q, i) => {
    const qNum = i + 1;
    const checked = document.querySelector(`input[name="${q.id}"]:checked`);
    let userAns = checked ? checked.value : null;
    const correctAns = q.correct || q.answer || q.key || q.correctAnswer;

    let marks = 0;
    let resultText = "";

    if (userAns === null) {
      marks = 0;
      resultText = "‚ö™ Not Attempted / I Don‚Äôt Know (0)";
      userAns = "Not Answered";
    } else if (userAns === correctAns) {
      marks = 4;
      resultText = "‚úÖ Correct (+4)";
    } else {
      marks = -1;
      resultText = "‚ùå Incorrect (-1)";
    }

    totalMarks += marks > 0 ? marks : 0;
    negativeMarks += marks < 0 ? marks : 0;

    details += `Q${qNum} ‚Üí ${resultText} (Your Ans: ${userAns} | Correct: ${correctAns})\n`;
  });

  const finalScore = totalMarks + negativeMarks;

  const message = `Sir, I have shared my Test Result for checking. Thank you!\n\nüìò Quiz Title: ${quizTitle}\nüë§ Student: ${student}\n\n${scoreText}\n\nüìä Summary:\n‚úî Total Marks (Possible): ${possibleMarks}\n‚úî Total Marks (Correct Answers): ${totalMarks}\n‚úî Negative Marks (Wrong Answers): ${negativeMarks}\n‚úî Final Score: ${finalScore}\n\nDetails:\n${details}`;

  const waUrl = `https://wa.me/${whatsappNumber}?text=${encodeURIComponent(message)}`;
  window.open(waUrl, "_blank");
});


const reportBtn = document.getElementById("reportBtn");
const reportModal = document.getElementById("reportModal");
const sendReport = document.getElementById("sendReport");
const closeReport = document.getElementById("closeReport");
const reportMsg = document.getElementById("reportMsg");

reportBtn.onclick = () => { reportModal.style.display = "block"; };
closeReport.onclick = () => { reportModal.style.display = "none"; reportMsg.value = ""; };
sendReport.onclick = () => {
  const msg = reportMsg.value.trim();
  if (!msg) { alert("Please write your message before sending."); return; }
  const whatsappNumber = "9108069409455";
  const message = `‚ö†Ô∏è Reported Mistake\n\nüìò Quiz Title: ${quizTitle}\nüë§ Student: ${student || "Anonymous"}\n\nüìù Message:\n${msg}`;
  const waUrl = `https://wa.me/${whatsappNumber}?text=${encodeURIComponent(message)}`;
  window.open(waUrl, "_blank");
  reportModal.style.display = "none";
  reportMsg.value = "";
};
</script>

</body>
</html>
